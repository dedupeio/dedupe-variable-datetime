branches:
    only:
        - master
        - "/^v.*$/"
language: python
matrix:
    include:
        - os: linux
          python: 2.7
        - os: linux
          python: 3.5
        - os: linux
          python: 3.6
        - os: osx
          before_install:
            - brew update
            - brew install python3
            - virtualenv env -p python3
            - source env/bin/activate
install:
    - pip install --upgrade pip
    - pip install --upgrade -r dev-requirements.txt
    - pip install -e .
script:
    - pytest -v tests
deploy:
    - provider: pypi
      skip_cleanup: true
      user: datamade.wheelbuilder
      on:
        tags: true
        condition: "$TRAVIS_OS_NAME = osx"
      distributions: bdist_wheel
      password: $PYPIPASSWORD